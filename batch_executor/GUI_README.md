# 批量游戏执行系统 - 图形界面

## 概述

这是一个简单易用的图形界面，用于批量执行掼蛋AI对战游戏。无需记忆复杂的命令行参数，通过可视化界面即可完成所有配置和执行。

## 启动方式

### Windows

双击运行 `START_GUI.bat`

### 命令行

```bash
python batch_executor_gui.py
```

## 界面功能

### 1. 配置区域

| 配置项 | 说明 | 示例 |
|--------|------|------|
| 目标场数 | 要执行的游戏总场数 | 100 |
| 服务器路径 | 服务器可执行文件路径 | guandan_offline_v1006.exe |
| 客户端脚本 | 客户端Python脚本（逗号分隔） | Test1.py, Test2.py, client.py, client.py |
| 诊断模式 | 仅诊断不执行游戏 | 勾选/不勾选 |

### 2. 控制按钮

- **▶ 开始执行**: 启动批量游戏执行
- **⏹ 停止**: 停止当前执行（保存进度）
- **清空日志**: 清空日志显示区域

### 3. 状态显示

- **进度条**: 可视化显示执行进度
- **已完成**: 当前完成场数 / 目标场数
- **重启次数**: 服务器自动重启次数
- **战绩**: 实时显示胜负统计

### 4. 日志区域

实时显示执行日志，不同颜色表示不同级别：
- **黑色**: 普通信息
- **绿色**: 成功信息
- **橙色**: 警告信息
- **红色**: 错误信息

## 使用流程

### 快速开始

1. **启动界面**
   ```
   双击 START_GUI.bat
   ```

2. **配置参数**
   - 输入目标场数（如：100）
   - 点击"浏览..."选择服务器文件
   - 输入客户端脚本路径

3. **开始执行**
   - 点击"▶ 开始执行"
   - 观察进度和日志
   - 等待完成或点击"停止"

### 诊断模式

如果游戏执行有问题，可以使用诊断模式：

1. 勾选"仅诊断模式"
2. 选择服务器路径
3. 点击"开始执行"
4. 查看诊断报告

诊断报告会显示：
- 发现的配置文件
- 期望的游戏次数
- 实际的游戏次数
- 参数不匹配的原因和建议

## 菜单功能

### 文件菜单

- **保存日志**: 将当前日志保存到文件
- **退出**: 关闭程序

### 帮助菜单

- **使用说明**: 显示简要使用说明
- **关于**: 显示版本和功能信息

## 高级功能

### 自动重启

系统会自动监控服务器状态：
- 服务器停止时自动重启
- 按顺序重启所有客户端
- 继续执行剩余场次

### 战绩跟踪

自动跟踪和累计战绩：
- 实时更新胜负统计
- 自动保存到文件
- 异常中断后可恢复

### 进度保存

执行过程中的状态会自动保存：
- 点击"停止"会保存当前进度
- 异常中断时自动保存
- 下次启动可以继续执行

## 配置示例

### 示例1: 标准4人对战

```
目标场数: 100
服务器路径: guandan_offline_v1006.exe
客户端脚本: 
  src/communication/Test1.py,
  src/communication/Test2.py,
  一等奖-东南大学-李菁-lalala-人机大赛/client.py,
  一等奖-东南大学-李菁-lalala-人机大赛/client.py
```

### 示例2: 诊断服务器配置

```
诊断模式: ✓ 勾选
服务器路径: guandan_offline_v1006.exe
```

## 常见问题

### Q: 界面启动失败？

**A**: 检查Python环境
```bash
python --version  # 需要 Python 3.8+
pip install -r requirements.txt
```

### Q: 找不到服务器文件？

**A**: 使用"浏览..."按钮手动选择，或检查文件路径是否正确

### Q: 客户端连接失败？

**A**: 
1. 检查客户端脚本路径是否正确
2. 确保所有脚本文件存在
3. 查看日志中的详细错误信息

### Q: 如何查看详细日志？

**A**: 
- 界面中的日志区域显示实时日志
- 完整日志保存在 `logs/batch_executor.log`
- 可通过"文件 > 保存日志"导出当前日志

### Q: 执行中断后如何继续？

**A**: 
- 系统会自动保存进度
- 重新启动并使用相同配置
- 系统会从上次中断处继续

### Q: 如何停止执行？

**A**: 
- 点击"⏹ 停止"按钮
- 系统会保存当前状态
- 等待当前游戏完成后停止

## 技术细节

### 依赖库

- `tkinter`: Python内置GUI库
- `threading`: 后台执行支持
- `batch_executor`: 核心执行模块

### 文件结构

```
batch_executor_gui.py    # GUI主程序
START_GUI.bat           # Windows启动脚本
GUI_使用说明.md          # 用户使用说明
batch_executor/         # 核心功能模块
  ├── main.py          # 主执行器
  ├── diagnostic.py    # 诊断模块
  ├── tracker.py       # 战绩跟踪
  └── ...
```

### 日志文件

- 位置: `logs/batch_executor.log`
- 格式: 时间戳 + 级别 + 消息
- 自动轮转: 超过10MB自动创建新文件

## 更新日志

### v1.0.0 (2024-01-01)

- ✨ 初始版本发布
- ✅ 基本GUI界面
- ✅ 配置管理
- ✅ 实时进度显示
- ✅ 日志查看
- ✅ 诊断模式
- ✅ 菜单功能

## 反馈与支持

如有问题或建议，请：
1. 查看 `GUI_使用说明.md`
2. 查看 `batch_executor/README.md`
3. 检查 `logs/batch_executor.log`

## 许可证

本软件仅供学习和研究使用。
